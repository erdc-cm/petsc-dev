The equation solved here is the 'quasigeostrophic' equation.

Take the advection-diffusion equation:
	dw/dt + u grad(w) - laplacian(w) = 0
Now evolve u as a function of w, by u = grad_perp K (w),
where K is and integral operator and grad_perp = (-d/dy, d/dx).
If K was convulution with 1/log(|z-w|) then this 2d equation would be for the vorticity in the NS
Instead we take K to be convolution with 1/|z-w|, which has a stronger singularity.
(the first is like inverse laplacian, the second like inverse sqrt laplacian).

Since the approach is to use finite element, we define each of our operators against test function.
Interpolate with trial functions, which are bilinear functions on each quadrilateral element, and test against same function space.

So instead of computing laplacian(w), we compute:

define the bilinear forms:
	a(u,v) = integral(gradu:gradv)      /weak laplacian
	b(u,v) = integral(gradu*v)             /weak gradient
	
and the trilinear form:
	c(w,u,v) = integral(w:gradu:v)       /weak advection

also the mass bilinear form
	m(u,v) = integral(u,v)                    /weak mass for time evolution

So the advection-diffusion equation, when tested againt a function in the class, becomes

d/dt(m(w,v)) + c(u,w,v) - a(w,v) = 0

so this is a matrix equation, when we compute (for a given u) the coeffictients of the operators
in some ordering of the basis functions.

(boundary conditions are applied to rows of matrix corresponding to elements on boundary)

________________

Want to calculate grad_perp K (w).
given K(w), the grad_perp operator is matrix we can compute and apply.
Want to apply K consistently with the rest of the formulation.

Thus K(w) = Integral{ 1/|x-z|*w(z)dz }

approximate as sum{ values at points / distance to the point }




	